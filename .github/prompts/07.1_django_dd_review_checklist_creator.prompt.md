---
description: Create comprehensive quality and security review checklists based on DD implementation from prompt 04
---

# Django Design Detail (DD) Review Checklist Creator

This prompt creates comprehensive checklists for code quality and security reviews based on DD requirements and implementation plan from prompt 04. This is the first part of the review workflow - creating the checklists.

## Prerequisites

**Required Input:**
- 📋 **Implementation Plan**: Output from `04_django_dd_implementation_plan.prompt.md`
- 📁 **DD Requirements**: Original DD specification files
- 📦 **Project Name**: `${input:project_name}`
- 🏷️ **App Name**: `${input:app_name}`
- 📂 **Code Base Path**: `${input:code_base_path}`
- 📄 **Implementation Plan Path**: `${input:implementation_plan_path}`

**Output Structure:**
This prompt follows the template defined in `.github/templates/output_templates.md` for Review Checklists (Prompt 07.1).

**Output Folder:** `review_checklists/`
**Main Output File:** `metadata/checklist_summary.json`

## Review Checklist Generation Workflow

### Step 1: Initialize Checklist Generation Environment

**Set up environment for checklist creation:**

```bash
echo "=== INITIALIZING REVIEW CHECKLIST CREATION ==="

# Create checklist directories
mkdir -p review_checklists/{quality,security,dd_compliance,templates}

# Load implementation plan
cat ${input:implementation_plan_path}/implementation_plan.json > review_checklists/implementation_plan.json

echo "✅ Implementation plan loaded for checklist generation"
echo "Project: ${input:project_name}"
echo "App: ${input:app_name}"
```

### Step 2: Generate Quality Review Checklist

**Create comprehensive quality checklist based on DD requirements:**

```python
# File: review_checklists/quality/quality_checklist_generator.py

"""
Quality review checklist generator based on DD requirements
"""

import json
from datetime import datetime
from pathlib import Path
from typing import Dict, List, Any

class QualityChecklistGenerator:
    """Generate quality review checklist based on DD requirements"""
    
    def __init__(self, implementation_plan: Dict, project_name: str, app_name: str):
        self.implementation_plan = implementation_plan
        self.dd_requirements = implementation_plan.get('dd_requirements', {})
        self.project_name = project_name
        self.app_name = app_name
        self.checklist = {
            'metadata': {
                'project': project_name,
                'app': app_name,
                'generated_at': datetime.now().isoformat(),
                'dd_name': implementation_plan.get('dd_name', 'Unknown'),
                'checklist_version': '1.0'
            },
            'categories': {}
        }
    
    def generate_django_best_practices_checklist(self) -> Dict:
        """Generate Django best practices checklist"""
        return {
            'name': 'Django Best Practices',
            'description': 'Standard Django development best practices',
            'weight': 25,
            'checks': [
                {
                    'id': 'DBP001',
                    'title': 'Model Field Definitions',
                    'description': 'All model fields have appropriate types and constraints',
                    'severity': 'high',
                    'criteria': [
                        'Fields use appropriate Django field types',
                        'Required fields are marked as required',
                        'String fields have appropriate max_length',
                        'Numeric fields have validators where needed',
                        'Choice fields use proper choices definition',
                        'Foreign keys have proper on_delete behavior'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/models.py'],
                    'automated_check': True,
                    'manual_verification': False
                },
                {
                    'id': 'DBP002',
                    'title': 'Model Meta Configuration',
                    'description': 'Models have proper Meta configuration',
                    'severity': 'medium',
                    'criteria': [
                        'Models have appropriate db_table names',
                        'Ordering is specified for display models',
                        'Indexes are defined for frequently queried fields',
                        'Unique constraints are properly defined',
                        'Verbose names are provided for user-facing models'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/models.py'],
                    'automated_check': True,
                    'manual_verification': True
                },
                {
                    'id': 'DBP003',
                    'title': 'Serializer Implementation',
                    'description': 'Serializers follow DRF best practices',
                    'severity': 'high',
                    'criteria': [
                        'Read and write serializers are separated when needed',
                        'Validation methods are implemented properly',
                        'Nested serialization is handled correctly',
                        'Field-level validation is comprehensive',
                        'Custom validation follows DRF patterns',
                        'to_representation and to_internal_value are overridden when needed'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/serializers.py'],
                    'automated_check': True,
                    'manual_verification': True
                },
                {
                    'id': 'DBP004',
                    'title': 'View Implementation',
                    'description': 'Views follow REST API best practices',
                    'severity': 'high',
                    'criteria': [
                        'ViewSets use appropriate base classes',
                        'Permissions are properly configured',
                        'Queryset optimization (select_related, prefetch_related)',
                        'Custom actions are well-documented',
                        'Error handling is implemented',
                        'HTTP status codes are appropriate'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/views.py'],
                    'automated_check': True,
                    'manual_verification': True
                },
                {
                    'id': 'DBP005',
                    'title': 'URL Configuration',
                    'description': 'URL patterns are properly configured',
                    'severity': 'medium',
                    'criteria': [
                        'Router is used for ViewSets',
                        'URL names follow naming conventions',
                        'App namespace is defined',
                        'Custom URL patterns are documented',
                        'URL patterns are RESTful'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/urls.py'],
                    'automated_check': True,
                    'manual_verification': False
                },
                {
                    'id': 'DBP006',
                    'title': 'Settings Configuration',
                    'description': 'Django settings follow best practices',
                    'severity': 'medium',
                    'criteria': [
                        'App is added to INSTALLED_APPS',
                        'Database settings are environment-specific',
                        'Static files configuration is correct',
                        'Security settings are properly configured',
                        'Environment variables are used for secrets'
                    ],
                    'files_to_check': ['config/settings/base.py', 'config/settings/development.py'],
                    'automated_check': True,
                    'manual_verification': True
                }
            ]
        }
    
    def generate_dd_requirements_checklist(self) -> Dict:
        """Generate checklist based on DD requirements"""
        api_endpoints = self.dd_requirements.get('api_endpoints', [])
        data_models = self.dd_requirements.get('data_models', [])
        business_rules = self.dd_requirements.get('business_rules', [])
        
        checks = []
        
        # API Requirements checks
        for i, endpoint in enumerate(api_endpoints, 1):
            checks.append({
                'id': f'DDR{i:03d}',
                'title': f'API Endpoint: {endpoint.get("path", "Unknown")}',
                'description': f'Implementation of {endpoint.get("method", "GET")} {endpoint.get("path", "")}',
                'severity': 'critical',
                'criteria': [
                    f'Endpoint {endpoint.get("path", "")} is implemented',
                    f'HTTP method {endpoint.get("method", "GET")} is supported',
                    'Request/response schemas match DD specifications',
                    'Authentication requirements are implemented',
                    'Permission requirements are enforced',
                    'Error responses are standardized'
                ],
                'files_to_check': [f'apps/{self.app_name}/views.py', f'apps/{self.app_name}/urls.py'],
                'automated_check': True,
                'manual_verification': True,
                'dd_reference': endpoint
            })
        
        # Data Model checks
        for i, model in enumerate(data_models, len(api_endpoints) + 1):
            checks.append({
                'id': f'DDR{i:03d}',
                'title': f'Data Model: {model.get("name", "Unknown")}',
                'description': f'Implementation of {model.get("name", "")} model',
                'severity': 'critical',
                'criteria': [
                    f'Model {model.get("name", "")} is implemented',
                    'All required fields are present',
                    'Field types match DD specifications',
                    'Relationships are correctly implemented',
                    'Constraints match DD requirements',
                    'Model methods are implemented as specified'
                ],
                'files_to_check': [f'apps/{self.app_name}/models.py'],
                'automated_check': True,
                'manual_verification': True,
                'dd_reference': model
            })
        
        # Business Rules checks
        for i, rule in enumerate(business_rules, len(api_endpoints) + len(data_models) + 1):
            checks.append({
                'id': f'DDR{i:03d}',
                'title': f'Business Rule: {rule.get("name", "Unknown")}',
                'description': f'Implementation of business rule: {rule.get("description", "")}',
                'severity': 'high',
                'criteria': [
                    'Business logic is implemented correctly',
                    'Rule conditions are properly validated',
                    'Error handling for rule violations',
                    'Rule is testable and tested',
                    'Documentation explains the rule implementation'
                ],
                'files_to_check': [
                    f'apps/{self.app_name}/models.py',
                    f'apps/{self.app_name}/serializers.py',
                    f'apps/{self.app_name}/views.py'
                ],
                'automated_check': False,
                'manual_verification': True,
                'dd_reference': rule
            })
        
        return {
            'name': 'DD Requirements Compliance',
            'description': 'Compliance with Design Detail requirements',
            'weight': 35,
            'checks': checks
        }
    
    def generate_code_quality_checklist(self) -> Dict:
        """Generate code quality checklist"""
        return {
            'name': 'Code Quality Standards',
            'description': 'Code quality, maintainability and documentation',
            'weight': 20,
            'checks': [
                {
                    'id': 'CQS001',
                    'title': 'Code Documentation',
                    'description': 'Code is properly documented',
                    'severity': 'medium',
                    'criteria': [
                        'All classes have docstrings',
                        'All public methods have docstrings',
                        'Complex business logic is commented',
                        'API endpoints are documented with proper docstrings',
                        'Model fields have help_text where appropriate'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/*.py'],
                    'automated_check': True,
                    'manual_verification': True
                },
                {
                    'id': 'CQS002',
                    'title': 'Code Style Compliance',
                    'description': 'Code follows PEP 8 and project style guidelines',
                    'severity': 'low',
                    'criteria': [
                        'Code follows PEP 8 style guidelines',
                        'Imports are properly organized',
                        'Line length is within limits (88-100 characters)',
                        'Naming conventions are consistent',
                        'Code is formatted consistently (Black/autopep8)'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/*.py'],
                    'automated_check': True,
                    'manual_verification': False
                },
                {
                    'id': 'CQS003',
                    'title': 'Error Handling',
                    'description': 'Proper error handling is implemented',
                    'severity': 'high',
                    'criteria': [
                        'Exceptions are properly handled',
                        'Error messages are user-friendly',
                        'Logging is implemented for errors',
                        'Graceful degradation is implemented',
                        'Validation errors are comprehensive and clear'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/*.py'],
                    'automated_check': True,
                    'manual_verification': True
                },
                {
                    'id': 'CQS004',
                    'title': 'Code Complexity',
                    'description': 'Code complexity is manageable',
                    'severity': 'medium',
                    'criteria': [
                        'Functions are not overly complex (McCabe < 10)',
                        'Classes have single responsibility',
                        'Methods are focused and small',
                        'Nested loops/conditions are minimized',
                        'Code is readable and maintainable'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/*.py'],
                    'automated_check': True,
                    'manual_verification': True
                },
                {
                    'id': 'CQS005',
                    'title': 'Test Coverage',
                    'description': 'Adequate test coverage is provided',
                    'severity': 'high',
                    'criteria': [
                        'Unit tests cover critical functionality',
                        'Test coverage is above 80%',
                        'Edge cases are tested',
                        'Integration tests are provided',
                        'Tests are maintainable and readable'
                    ],
                    'files_to_check': [f'tests/test_{self.app_name}/*.py'],
                    'automated_check': True,
                    'manual_verification': True
                }
            ]
        }
    
    def generate_performance_checklist(self) -> Dict:
        """Generate performance review checklist"""
        return {
            'name': 'Performance Optimization',
            'description': 'Performance and scalability considerations',
            'weight': 20,
            'checks': [
                {
                    'id': 'PER001',
                    'title': 'Database Query Optimization',
                    'description': 'Database queries are optimized',
                    'severity': 'high',
                    'criteria': [
                        'N+1 query problems are avoided',
                        'select_related is used for ForeignKey fields',
                        'prefetch_related is used for ManyToMany fields',
                        'Database indexes are properly utilized',
                        'Bulk operations are used where appropriate'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/views.py', f'apps/{self.app_name}/models.py'],
                    'automated_check': True,
                    'manual_verification': True
                },
                {
                    'id': 'PER002',
                    'title': 'API Response Time',
                    'description': 'API endpoints meet response time requirements',
                    'severity': 'high',
                    'criteria': [
                        'Endpoints respond within required time limits',
                        'Pagination is implemented for large datasets',
                        'Filtering reduces response payload effectively',
                        'Unnecessary data is not included in responses',
                        'Caching is used where appropriate'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/views.py'],
                    'automated_check': True,
                    'manual_verification': True
                },
                {
                    'id': 'PER003',
                    'title': 'Memory Usage',
                    'description': 'Memory usage is optimized',
                    'severity': 'medium',
                    'criteria': [
                        'Large querysets are paginated',
                        'Bulk operations use bulk_create/bulk_update',
                        'Temporary objects are properly cleaned up',
                        'Iterator is used for large datasets',
                        'Memory leaks are avoided'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/*.py'],
                    'automated_check': True,
                    'manual_verification': True
                },
                {
                    'id': 'PER004',
                    'title': 'Caching Strategy',
                    'description': 'Appropriate caching is implemented',
                    'severity': 'medium',
                    'criteria': [
                        'Cache is used for expensive computations',
                        'Cache invalidation strategy is implemented',
                        'Cache keys are well-designed',
                        'Cache timeouts are appropriate',
                        'Cache hit/miss ratios are monitored'
                    ],
                    'files_to_check': [f'apps/{self.app_name}/views.py'],
                    'automated_check': False,
                    'manual_verification': True
                }
            ]
        }
    
    def generate_complete_quality_checklist(self) -> Dict:
        """Generate complete quality checklist"""
        print("Generating comprehensive quality review checklist...")
        
        self.checklist['categories'] = {
            'django_best_practices': self.generate_django_best_practices_checklist(),
            'dd_requirements': self.generate_dd_requirements_checklist(),
            'code_quality': self.generate_code_quality_checklist(),
            'performance': self.generate_performance_checklist()
        }
        
        # Calculate total checks
        total_checks = sum(
            len(category['checks'])
            for category in self.checklist['categories'].values()
        )
        
        self.checklist['metadata']['total_checks'] = total_checks
        
        return self.checklist
    
    def save_quality_checklist(self, output_path: str):
        """Save quality checklist to file"""
        checklist = self.generate_complete_quality_checklist()
        
        Path(output_path).mkdir(parents=True, exist_ok=True)
        
        with open(f"{output_path}/quality_checklist.json", 'w') as f:
            json.dump(checklist, f, indent=2)
        
        # Generate human-readable checklist
        self._generate_readable_checklist(checklist, output_path)
        
        print(f"✅ Quality checklist generated with {checklist['metadata']['total_checks']} checks")
        return checklist
    
    def _generate_readable_checklist(self, checklist: Dict, output_path: str):
        """Generate human-readable checklist"""
        
        readable_content = f"""# Code Quality Review Checklist

**Project**: {checklist['metadata']['project']}
**App**: {checklist['metadata']['app']}
**Generated**: {checklist['metadata']['generated_at']}
**Total Checks**: {checklist['metadata']['total_checks']}

"""
        
        for category_key, category in checklist['categories'].items():
            readable_content += f"## {category['name']} (Weight: {category['weight']}%)\n\n"
            readable_content += f"{category['description']}\n\n"
            
            for check in category['checks']:
                readable_content += f"### {check['id']}: {check['title']}\n\n"
                readable_content += f"**Severity**: {check['severity'].title()}\n"
                readable_content += f"**Description**: {check['description']}\n\n"
                
                readable_content += "**Criteria**:\n"
                for criterion in check['criteria']:
                    readable_content += f"- [ ] {criterion}\n"
                
                readable_content += f"\n**Files to Check**: {', '.join(check['files_to_check'])}\n"
                readable_content += f"**Automated Check**: {'Yes' if check['automated_check'] else 'No'}\n"
                readable_content += f"**Manual Verification**: {'Yes' if check.get('manual_verification', False) else 'No'}\n\n"
                readable_content += "---\n\n"
        
        with open(f"{output_path}/quality_checklist.md", 'w') as f:
            f.write(readable_content)


def generate_quality_checklist():
    """Main function to generate quality checklist"""
    
    # Load implementation plan
    with open('review_checklists/implementation_plan.json', 'r') as f:
        implementation_plan = json.load(f)
    
    generator = QualityChecklistGenerator(
        implementation_plan=implementation_plan,
        project_name='${input:project_name}',
        app_name='${input:app_name}'
    )
    
    checklist = generator.save_quality_checklist('review_checklists/quality')
    
    return checklist


if __name__ == '__main__':
    generate_quality_checklist()
```

### Step 3: Generate Security Review Checklist

**Create comprehensive security checklist based on OWASP and Django security guidelines:**

```python
# File: review_checklists/security/security_checklist_generator.py

"""
Security review checklist generator based on OWASP and Django security guidelines
"""

import json
from datetime import datetime
from typing import Dict, List
from pathlib import Path

class SecurityChecklistGenerator:
    """Generate security review checklist"""
    
    def __init__(self, implementation_plan: Dict, project_name: str, app_name: str):
        self.implementation_plan = implementation_plan
        self.dd_requirements = implementation_plan.get('dd_requirements', {})
        self.project_name = project_name
        self.app_name = app_name
        self.checklist = {
            'metadata': {
                'project': project_name,
                'app': app_name,
                'generated_at': datetime.now().isoformat(),
                'security_frameworks': ['OWASP Top 10 2021', 'Django Security Guidelines'],
                'checklist_version': '1.0'
            },
            'categories': {}
        }
    
    def generate_owasp_top10_checklist(self) -> Dict:
        """Generate OWASP Top 10 security checklist"""
        return {
            'name': 'OWASP Top 10 Security Risks',
            'description': 'Protection against OWASP Top 10 security vulnerabilities (2021)',
            'weight': 40,
            'checks': [
                {
                    'id': 'OWASP001',
                    'title': 'A01:2021 – Broken Access Control',
                    'description': 'Access control enforces policy such that users cannot act outside of their intended permissions',
                    'severity': 'critical',
                    'criteria': [
                        'Access control is enforced server-side',
                        'Users can only access their authorized resources',
                        'Administrative functions are properly protected',
                        'Direct object references are validated',
                        'Default access is deny',
                        'CORS policy is properly configured'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/views.py',
                        f'apps/{self.app_name}/permissions.py',
                        'config/settings/*.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'OWASP002', 
                    'title': 'A02:2021 – Cryptographic Failures',
                    'description': 'Protection of sensitive data in transit and at rest',
                    'severity': 'critical',
                    'criteria': [
                        'Sensitive data is encrypted at rest and in transit',
                        'Secrets are not hardcoded in source code',
                        'Environment variables are used for configuration',
                        'Strong encryption algorithms are used',
                        'Key management is properly implemented',
                        'TLS/SSL is properly configured'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/*.py',
                        'config/settings/*.py',
                        '.env*'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'OWASP003',
                    'title': 'A03:2021 – Injection',
                    'description': 'Protection against SQL, NoSQL, OS, and LDAP injection',
                    'severity': 'critical',
                    'criteria': [
                        'Django ORM is used instead of raw SQL queries',
                        'User input is properly validated and sanitized',
                        'Parameterized queries are used when raw SQL is necessary',
                        'Input validation is performed server-side',
                        'Command injection is prevented in system calls',
                        'LDAP injection protection is implemented'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/models.py',
                        f'apps/{self.app_name}/views.py',
                        f'apps/{self.app_name}/serializers.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'OWASP004',
                    'title': 'A04:2021 – Insecure Design',
                    'description': 'Secure design patterns and architecture',
                    'severity': 'high',
                    'criteria': [
                        'Threat modeling is performed',
                        'Secure design patterns are used',
                        'Defense in depth strategy is implemented',
                        'Principle of least privilege is applied',
                        'Secure defaults are configured',
                        'Input validation follows allow-list approach'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/*.py',
                        'config/settings/*.py'
                    ],
                    'automated_check': False,
                    'manual_check': True
                },
                {
                    'id': 'OWASP005',
                    'title': 'A05:2021 – Security Misconfiguration',
                    'description': 'Secure configuration management',
                    'severity': 'high',
                    'criteria': [
                        'Security headers are properly configured',
                        'Debug mode is disabled in production',
                        'Error messages do not leak sensitive information',
                        'Default credentials are changed',
                        'Unnecessary features are disabled',
                        'Security settings are properly configured'
                    ],
                    'files_to_check': [
                        'config/settings/*.py',
                        'config/urls.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'OWASP006',
                    'title': 'A06:2021 – Vulnerable and Outdated Components',
                    'description': 'Secure dependency management',
                    'severity': 'high',
                    'criteria': [
                        'Dependencies are regularly updated',
                        'Vulnerability scanning is performed',
                        'Only necessary components are included',
                        'Component inventory is maintained',
                        'Security advisories are monitored'
                    ],
                    'files_to_check': [
                        'requirements.txt',
                        'requirements/*.txt'
                    ],
                    'automated_check': True,
                    'manual_check': False
                },
                {
                    'id': 'OWASP007',
                    'title': 'A07:2021 – Identification and Authentication Failures',
                    'description': 'Strong authentication and session management',
                    'severity': 'critical',
                    'criteria': [
                        'Strong authentication mechanisms are implemented',
                        'Session tokens are properly managed',
                        'Password policies are enforced',
                        'Multi-factor authentication is considered',
                        'Account lockout mechanisms are in place',
                        'Session fixation is prevented'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/views.py',
                        'config/settings/*.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'OWASP008',
                    'title': 'A08:2021 – Software and Data Integrity Failures',
                    'description': 'Protection against integrity failures',
                    'severity': 'high',
                    'criteria': [
                        'Digital signatures are used for software updates',
                        'CI/CD pipelines are secured',
                        'Serialization is performed safely',
                        'Untrusted data is not deserialized',
                        'Integrity checks are performed',
                        'Auto-update mechanisms are secured'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/serializers.py',
                        f'apps/{self.app_name}/views.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'OWASP009',
                    'title': 'A09:2021 – Security Logging and Monitoring Failures',
                    'description': 'Comprehensive logging and monitoring',
                    'severity': 'medium',
                    'criteria': [
                        'Security events are logged',
                        'Log integrity is protected',
                        'Logs are monitored for suspicious activity',
                        'Alerting mechanisms are in place',
                        'Log retention policies are implemented',
                        'Logs do not contain sensitive data'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/*.py',
                        'config/settings/*.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'OWASP010',
                    'title': 'A10:2021 – Server-Side Request Forgery',
                    'description': 'Protection against SSRF attacks',
                    'severity': 'medium',
                    'criteria': [
                        'URL validation is implemented',
                        'Allow-list approach for remote resources',
                        'Network segmentation is in place',
                        'Response validation is performed',
                        'DNS resolution is controlled',
                        'Raw response data is not returned to client'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/views.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                }
            ]
        }
    
    def generate_django_security_checklist(self) -> Dict:
        """Generate Django-specific security checklist"""
        return {
            'name': 'Django Security Best Practices',
            'description': 'Django framework-specific security considerations',
            'weight': 30,
            'checks': [
                {
                    'id': 'DSP001',
                    'title': 'Django Security Settings',
                    'description': 'Essential Django security settings are configured',
                    'severity': 'critical',
                    'criteria': [
                        'SECRET_KEY is not hardcoded and is unique',
                        'DEBUG is False in production',
                        'ALLOWED_HOSTS is properly configured',
                        'SECURE_SSL_REDIRECT is enabled in production',
                        'SESSION_COOKIE_SECURE is True',
                        'CSRF_COOKIE_SECURE is True'
                    ],
                    'files_to_check': ['config/settings/*.py'],
                    'automated_check': True,
                    'manual_check': False
                },
                {
                    'id': 'DSP002',
                    'title': 'CSRF Protection',
                    'description': 'Cross-Site Request Forgery protection is enabled',
                    'severity': 'high',
                    'criteria': [
                        'CSRF middleware is enabled',
                        'CSRF tokens are used in forms',
                        'CSRF protection is not disabled',
                        'Custom views handle CSRF properly',
                        'AJAX requests include CSRF tokens'
                    ],
                    'files_to_check': [
                        'config/settings/*.py',
                        f'apps/{self.app_name}/views.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'DSP003',
                    'title': 'XSS Protection',
                    'description': 'Cross-Site Scripting protection is implemented',
                    'severity': 'high',
                    'criteria': [
                        'Auto-escaping is enabled in templates',
                        'mark_safe is used carefully',
                        'User input is properly escaped',
                        'Content-Type headers are set correctly',
                        'X-XSS-Protection header is enabled'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/views.py',
                        'templates/*.html'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'DSP004',
                    'title': 'Authentication and Authorization',
                    'description': 'Proper authentication and authorization are implemented',
                    'severity': 'critical',
                    'criteria': [
                        'Authentication backend is properly configured',
                        'Password validation is enabled',
                        'User permissions are properly checked',
                        'Login/logout views are secured',
                        'Session management is secure'
                    ],
                    'files_to_check': [
                        'config/settings/*.py',
                        f'apps/{self.app_name}/views.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'DSP005',
                    'title': 'SQL Injection Protection',
                    'description': 'SQL injection attacks are prevented',
                    'severity': 'critical',
                    'criteria': [
                        'Django ORM is used for database operations',
                        'Raw SQL queries use parameterization',
                        'User input is not directly concatenated to SQL',
                        'Database permissions are minimal',
                        'SQL queries are properly validated'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/models.py',
                        f'apps/{self.app_name}/views.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                }
            ]
        }
    
    def generate_api_security_checklist(self) -> Dict:
        """Generate API-specific security checklist"""
        return {
            'name': 'API Security',
            'description': 'REST API security considerations',
            'weight': 30,
            'checks': [
                {
                    'id': 'API001',
                    'title': 'API Authentication',
                    'description': 'API endpoints are properly authenticated',
                    'severity': 'critical',
                    'criteria': [
                        'Authentication is required for protected endpoints',
                        'API keys/tokens are properly validated',
                        'Token expiration is implemented',
                        'Rate limiting is implemented',
                        'Authentication errors are handled properly'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/views.py',
                        'config/settings/*.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'API002',
                    'title': 'Input Validation',
                    'description': 'API input is properly validated',
                    'severity': 'high',
                    'criteria': [
                        'All input data is validated',
                        'Serializers have proper validation',
                        'File uploads are validated',
                        'Content-Type validation is performed',
                        'Input size limits are enforced'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/serializers.py',
                        f'apps/{self.app_name}/views.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'API003',
                    'title': 'Error Handling',
                    'description': 'API errors are handled securely',
                    'severity': 'medium',
                    'criteria': [
                        'Error messages do not leak sensitive information',
                        'Stack traces are not exposed in production',
                        'Consistent error response format',
                        'Proper HTTP status codes are used',
                        'Error logging is implemented'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/views.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                },
                {
                    'id': 'API004',
                    'title': 'Data Exposure',
                    'description': 'Sensitive data is not exposed through API',
                    'severity': 'high',
                    'criteria': [
                        'Sensitive fields are excluded from serialization',
                        'Pagination prevents data enumeration',
                        'Filtering is properly implemented',
                        'Response data is minimized',
                        'PII is properly protected'
                    ],
                    'files_to_check': [
                        f'apps/{self.app_name}/serializers.py',
                        f'apps/{self.app_name}/views.py'
                    ],
                    'automated_check': True,
                    'manual_check': True
                }
            ]
        }
    
    def generate_complete_security_checklist(self) -> Dict:
        """Generate complete security checklist"""
        print("Generating comprehensive security review checklist...")
        
        self.checklist['categories'] = {
            'owasp_top10': self.generate_owasp_top10_checklist(),
            'django_security': self.generate_django_security_checklist(),
            'api_security': self.generate_api_security_checklist()
        }
        
        # Calculate total checks
        total_checks = sum(
            len(category['checks'])
            for category in self.checklist['categories'].values()
        )
        
        self.checklist['metadata']['total_checks'] = total_checks
        
        return self.checklist
    
    def save_security_checklist(self, output_path: str):
        """Save security checklist to file"""
        checklist = self.generate_complete_security_checklist()
        
        Path(output_path).mkdir(parents=True, exist_ok=True)
        
        with open(f"{output_path}/security_checklist.json", 'w') as f:
            json.dump(checklist, f, indent=2)
        
        # Generate human-readable checklist
        self._generate_readable_checklist(checklist, output_path)
        
        print(f"✅ Security checklist generated with {checklist['metadata']['total_checks']} checks")
        return checklist
    
    def _generate_readable_checklist(self, checklist: Dict, output_path: str):
        """Generate human-readable security checklist"""
        
        readable_content = f"""# Security Review Checklist

**Project**: {checklist['metadata']['project']}
**App**: {checklist['metadata']['app']}
**Generated**: {checklist['metadata']['generated_at']}
**Security Frameworks**: {', '.join(checklist['metadata']['security_frameworks'])}
**Total Checks**: {checklist['metadata']['total_checks']}

"""
        
        for category_key, category in checklist['categories'].items():
            readable_content += f"## {category['name']} (Weight: {category['weight']}%)\n\n"
            readable_content += f"{category['description']}\n\n"
            
            for check in category['checks']:
                readable_content += f"### {check['id']}: {check['title']}\n\n"
                readable_content += f"**Severity**: {check['severity'].title()}\n"
                readable_content += f"**Description**: {check['description']}\n\n"
                
                readable_content += "**Security Criteria**:\n"
                for criterion in check['criteria']:
                    readable_content += f"- [ ] {criterion}\n"
                
                readable_content += f"\n**Files to Check**: {', '.join(check['files_to_check'])}\n"
                readable_content += f"**Automated Check**: {'Yes' if check['automated_check'] else 'No'}\n"
                readable_content += f"**Manual Check**: {'Yes' if check['manual_check'] else 'No'}\n\n"
                readable_content += "---\n\n"
        
        with open(f"{output_path}/security_checklist.md", 'w') as f:
            f.write(readable_content)


def generate_security_checklist():
    """Main function to generate security checklist"""
    
    # Load implementation plan
    with open('review_checklists/implementation_plan.json', 'r') as f:
        implementation_plan = json.load(f)
    
    generator = SecurityChecklistGenerator(
        implementation_plan=implementation_plan,
        project_name='${input:project_name}',
        app_name='${input:app_name}'
    )
    
    checklist = generator.save_security_checklist('review_checklists/security')
    
    return checklist


if __name__ == '__main__':
    generate_security_checklist()
```

### Step 4: Generate Checklist Summary and Templates

**Create summary and templates for manual reviews:**

```python
# File: review_checklists/checklist_summary_generator.py

"""
Generate comprehensive checklist summary and review templates
"""

import json
from datetime import datetime
from pathlib import Path

class ChecklistSummaryGenerator:
    """Generate checklist summary and review templates"""
    
    def __init__(self, app_name: str):
        self.app_name = app_name
    
    def generate_combined_summary(self) -> Dict:
        """Generate combined summary of all checklists"""
        
        # Load quality checklist
        with open('review_checklists/quality/quality_checklist.json', 'r') as f:
            quality_checklist = json.load(f)
        
        # Load security checklist
        with open('review_checklists/security/security_checklist.json', 'r') as f:
            security_checklist = json.load(f)
        
        summary = {
            'metadata': {
                'app_name': self.app_name,
                'generated_at': datetime.now().isoformat(),
                'checklist_types': ['quality', 'security']
            },
            'summary_statistics': {
                'total_quality_checks': quality_checklist['metadata']['total_checks'],
                'total_security_checks': security_checklist['metadata']['total_checks'],
                'total_checks': quality_checklist['metadata']['total_checks'] + security_checklist['metadata']['total_checks']
            },
            'checklist_breakdown': {
                'quality_categories': list(quality_checklist['categories'].keys()),
                'security_categories': list(security_checklist['categories'].keys())
            },
            'severity_breakdown': self._calculate_severity_breakdown(quality_checklist, security_checklist),
            'review_workflow': {
                'automated_checks': self._count_automated_checks(quality_checklist, security_checklist),
                'manual_checks': self._count_manual_checks(quality_checklist, security_checklist)
            }
        }
        
        return summary
    
    def _calculate_severity_breakdown(self, quality_checklist: Dict, security_checklist: Dict) -> Dict:
        """Calculate breakdown by severity"""
        severity_count = {'critical': 0, 'high': 0, 'medium': 0, 'low': 0}
        
        # Count from quality checklist
        for category in quality_checklist['categories'].values():
            for check in category['checks']:
                severity = check.get('severity', 'medium')
                severity_count[severity] += 1
        
        # Count from security checklist
        for category in security_checklist['categories'].values():
            for check in category['checks']:
                severity = check.get('severity', 'medium')
                severity_count[severity] += 1
        
        return severity_count
    
    def _count_automated_checks(self, quality_checklist: Dict, security_checklist: Dict) -> int:
        """Count automated checks"""
        count = 0
        
        for category in quality_checklist['categories'].values():
            for check in category['checks']:
                if check.get('automated_check', False):
                    count += 1
        
        for category in security_checklist['categories'].values():
            for check in category['checks']:
                if check.get('automated_check', False):
                    count += 1
        
        return count
    
    def _count_manual_checks(self, quality_checklist: Dict, security_checklist: Dict) -> int:
        """Count manual checks"""
        count = 0
        
        for category in quality_checklist['categories'].values():
            for check in category['checks']:
                if check.get('manual_verification', False) or check.get('manual_check', False):
                    count += 1
        
        for category in security_checklist['categories'].values():
            for check in category['checks']:
                if check.get('manual_check', False):
                    count += 1
        
        return count
    
    def generate_review_template(self) -> str:
        """Generate review template for manual reviews"""
        
        template = f"""# Code Review Template - {self.app_name}

**Reviewer**: [Reviewer Name]
**Review Date**: [Date]
**Review Type**: [Quality/Security/Both]

## Review Instructions

1. Use the generated checklists as a guide
2. Mark each item as Pass/Fail/N/A
3. Provide comments for any failures
4. Include recommendations for improvements

## Quick Review Summary

- **Overall Status**: [Pass/Conditional Pass/Fail]
- **Critical Issues**: [Number]
- **High Priority Issues**: [Number]
- **Recommendations**: [Summary]

## Detailed Review Results

### Quality Review Checklist
[Import from review_checklists/quality/quality_checklist.md]

### Security Review Checklist  
[Import from review_checklists/security/security_checklist.md]

## Review Comments

### Critical Issues Found
[List any critical issues that must be fixed]

### Recommendations for Improvement
[List recommendations for code improvement]

### Positive Observations
[List what was done well]

## Review Decision

- [ ] **Approve**: Code meets all requirements
- [ ] **Conditional Approve**: Minor issues to be addressed
- [ ] **Request Changes**: Significant issues must be fixed
- [ ] **Reject**: Major problems require redesign

**Reviewer Signature**: [Name and Date]
"""
        
        return template
    
    def save_summary_and_templates(self):
        """Save summary and templates"""
        
        # Generate combined summary
        summary = self.generate_combined_summary()
        
        with open('review_checklists/checklist_summary.json', 'w') as f:
            json.dump(summary, f, indent=2)
        
        # Generate review template
        template = self.generate_review_template()
        
        Path('review_checklists/templates').mkdir(exist_ok=True)
        with open('review_checklists/templates/review_template.md', 'w') as f:
            f.write(template)
        
        # Generate summary report
        summary_report = f"""
=== REVIEW CHECKLIST SUMMARY ===

App: {self.app_name}
Generated: {summary['metadata']['generated_at']}

CHECKLIST STATISTICS:
- Total Checks: {summary['summary_statistics']['total_checks']}
- Quality Checks: {summary['summary_statistics']['total_quality_checks']}
- Security Checks: {summary['summary_statistics']['total_security_checks']}

SEVERITY BREAKDOWN:
- Critical: {summary['severity_breakdown']['critical']}
- High: {summary['severity_breakdown']['high']}
- Medium: {summary['severity_breakdown']['medium']}
- Low: {summary['severity_breakdown']['low']}

REVIEW WORKFLOW:
- Automated Checks: {summary['review_workflow']['automated_checks']}
- Manual Checks: {summary['review_workflow']['manual_checks']}

FILES GENERATED:
- Quality Checklist: review_checklists/quality/quality_checklist.json
- Security Checklist: review_checklists/security/security_checklist.json
- Combined Summary: review_checklists/checklist_summary.json
- Review Template: review_checklists/templates/review_template.md

NEXT STEPS:
1. Run prompt 07.2 to execute automated reviews
2. Use generated templates for manual reviews
3. Address any issues found during review
"""
        
        with open('review_checklists/summary_report.txt', 'w') as f:
            f.write(summary_report)
        
        print(summary_report)
        
        return summary


def generate_checklist_summary():
    """Main function to generate checklist summary"""
    generator = ChecklistSummaryGenerator('${input:app_name}')
    summary = generator.save_summary_and_templates()
    return summary


if __name__ == '__main__':
    generate_checklist_summary()
```

## Output Generation

**Create the standardized review checklist output using the template structure:**

```python
# Generate review checklist summary following template structure
import json
from datetime import datetime
from pathlib import Path

def generate_review_checklist_output():
    """Generate standardized review checklist output"""
    
    # Create output directory structure
    base_dir = Path('review_checklists')
    base_dir.mkdir(exist_ok=True)
    
    # Create subdirectories following template
    for subdir in ['metadata', 'quality', 'security', 'dd_compliance', 'templates', 'documentation']:
        (base_dir / subdir).mkdir(exist_ok=True)
    
    # Generate main checklist summary JSON
    checklist_summary = {
        "metadata": {
            "project_name": "${input:project_name}",
            "app_name": "${input:app_name}",
            "dd_name": "${input:dd_name}",
            "generated_at": datetime.now().isoformat(),
            "generated_by": "prompt_07.1",
            "version": "1.0",
            "security_frameworks": ["OWASP Top 10 2021", "Django Security Guidelines"]
        },
        "checklist_summary": {
            "total_checks": 0,  # Will be calculated
            "quality_checks": 0,
            "security_checks": 0,
            "dd_compliance_checks": 0,
            "automated_checks": 0,
            "manual_checks": 0
        },
        "quality_checklist": {
            "categories": {
                "django_best_practices": {
                    "weight": 30,
                    "check_count": 0
                },
                "code_quality_standards": {
                    "weight": 25,
                    "check_count": 0
                },
                "performance_optimization": {
                    "weight": 20,
                    "check_count": 0
                },
                "dd_compliance": {
                    "weight": 25,
                    "check_count": 0
                }
            }
        },
        "security_checklist": {
            "categories": {
                "owasp_top10": {
                    "weight": 40,
                    "check_count": 0
                },
                "django_security": {
                    "weight": 35,
                    "check_count": 0
                },
                "api_security": {
                    "weight": 25,
                    "check_count": 0
                }
            }
        },
        "severity_breakdown": {
            "critical": 0,
            "high": 0,
            "medium": 0,
            "low": 0
        },
        "review_workflow": {
            "automated_tools": ["bandit", "safety", "flake8", "custom_checks"],
            "manual_review_areas": [],
            "estimated_review_time": "2-4 hours"
        },
        "next_steps": [
            "Run prompt 07.2 to execute automated reviews",
            "Use templates for manual reviews",
            "Address findings and re-review"
        ]
    }
    
    # Save main checklist summary
    with open(base_dir / 'metadata' / 'checklist_summary.json', 'w') as f:
        json.dump(checklist_summary, f, indent=2)
    
    # Generate supporting documentation
    generate_checklist_documentation(base_dir)
    
    print(f"✅ Review checklist output created in {base_dir}/")
    print(f"📄 Main file: {base_dir}/metadata/checklist_summary.json")
    print(f"📚 Documentation: {base_dir}/documentation/")
    
    return checklist_summary

def generate_checklist_documentation(base_dir):
    """Generate checklist documentation files"""
    
    # Generate review guidelines markdown
    review_guidelines_md = f"""
# Review Guidelines: ${{input:dd_name}}

## Overview
[Review guidelines overview and strategy]

## Quality Review Process
[Quality review process and criteria]

## Security Review Process
[Security review process and compliance requirements]

## Review Templates
[Instructions for using review templates]

## Scoring Methodology
[How review scores are calculated]
"""
    
    with open(base_dir / 'documentation' / 'review_guidelines.md', 'w') as f:
        f.write(review_guidelines_md)

# Execute checklist generation workflow
def execute_checklist_generation():
    """Execute complete checklist generation workflow"""
    print("=== EXECUTING REVIEW CHECKLIST CREATION ===")
    
    # Step 1: Generate quality checklist
    print("Step 1: Generating quality review checklist...")
    # Generate quality checklist based on implementation plan
    
    # Step 2: Generate security checklist
    print("Step 2: Generating security review checklist...")
    # Generate security checklist based on OWASP and Django guidelines
    
    # Step 3: Generate DD compliance checklist
    print("Step 3: Generating DD compliance checklist...")
    # Generate DD compliance checklist based on requirements
    
    # Step 4: Create standardized output
    print("Step 4: Creating standardized output...")
    summary = generate_review_checklist_output()
    
    print("✅ Review checklist creation complete!")
    print("📄 Quality Checklist: review_checklists/quality/quality_checklist.md")
    print("🔒 Security Checklist: review_checklists/security/security_checklist.md")
    print("📊 Summary Report: review_checklists/metadata/checklist_summary.json")
    print("📝 Review Template: review_checklists/templates/review_template.md")
    print("")
    print("Next step: Run prompt 07.2 to execute automated reviews and generate reports")
    
    return summary

# Execute the workflow
execute_checklist_generation()
```

## Template Validation

**Ensure output meets template requirements:**

✅ **Metadata Section**: Complete with project info, DD name, generation timestamp, security frameworks  
✅ **Folder Structure**: Follows standardized template with metadata/, quality/, security/, etc.  
✅ **JSON Schema**: Matches template structure for review checklists  
✅ **Checklist Categories**: All review categories covered with proper weighting  
✅ **Documentation**: Includes both JSON and markdown formats  
✅ **Review Workflow**: Automated tools and manual review areas defined  
✅ **Cross-Prompt Compatibility**: Output format compatible with prompt 07.2 input requirements

## Success Criteria

**Checklist creation is successful when:**

✅ **Quality checklist is generated with Django best practices**  
✅ **Security checklist covers OWASP Top 10 and Django security**  
✅ **DD compliance checklist is based on actual requirements**  
✅ **All checklists are in both JSON and markdown formats**  
✅ **Review templates are generated for manual reviews**  
✅ **Comprehensive summary shows checklist statistics**  
✅ **Files are organized in proper directory structure**

---

**Note**: This prompt creates comprehensive review checklists. Use prompt 07.2 to execute the automated reviews and generate findings reports.